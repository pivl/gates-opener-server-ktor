# üêß –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–±–æ—Ä–∫–µ Linux executables

## üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–µ–∂–∏–º—ã —Å–±–æ—Ä–∫–∏

### 1. üçé **–û–±—ã—á–Ω–∞—è —Å–±–æ—Ä–∫–∞ (–≤—Å–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã)**
```bash
./gradlew linkLinuxBinaries
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ `gatesopener/bin/gates-opener-server-ktor-amd64` (Linux x86_64)
- ‚úÖ `gatesopener/bin/gates-opener-server-ktor-aarch64` (Linux ARM64)

### 2. üê≥ **Docker —Å–±–æ—Ä–∫–∞ x86_64**
```bash
./build-linux.sh
```
**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `Dockerfile.build`
- –û—Ç–∫–ª—é—á–∞–µ—Ç ARM64 target (`-Ddocker.build=true`)
- –†–µ–∑—É–ª—å—Ç–∞—Ç: —Ç–æ–ª—å–∫–æ x86_64 executable

### 3. ü¶æ **Docker —Å–±–æ—Ä–∫–∞ ARM64**
```bash
./build-linux-arm64.sh
```
**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `Dockerfile.build-arm64`
- –û—Ç–∫–ª—é—á–∞–µ—Ç x86_64 target (`-Ddocker.build.arm64=true`)
- –ë–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑: `arm64v8/openjdk:17-jdk-slim`
- –†–µ–∑—É–ª—å—Ç–∞—Ç: —Ç–æ–ª—å–∫–æ ARM64 executable

## üîß –°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞

### `docker.build=true`
**–≠—Ñ—Ñ–µ–∫—Ç:**
- ‚ùå –û—Ç–∫–ª—é—á–∞–µ—Ç `linuxArm64` target
- ‚úÖ –í–∫–ª—é—á–∞–µ—Ç `linuxX64` target
- ‚úÖ –í–∫–ª—é—á–∞–µ—Ç `macosArm64` target

### `docker.build.arm64=true`
**–≠—Ñ—Ñ–µ–∫—Ç:**
- ‚úÖ –í–∫–ª—é—á–∞–µ—Ç `linuxArm64` target
- ‚ùå –û—Ç–∫–ª—é—á–∞–µ—Ç `linuxX64` target
- ‚úÖ –í–∫–ª—é—á–∞–µ—Ç `macosArm64` target

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

### Docker x86_64 —Å–±–æ—Ä–∫–∞
- **Dockerfile:** `Dockerfile.build`
- **–°–∫—Ä–∏–ø—Ç:** `build-linux.sh`
- **–ó–∞–¥–∞—á–∞:** `linkLinuxX64Only`
- **–û–±—Ä–∞–∑:** `gates-opener-builder`

### Docker ARM64 —Å–±–æ—Ä–∫–∞
- **Dockerfile:** `Dockerfile.build-arm64`
- **–°–∫—Ä–∏–ø—Ç:** `build-linux-arm64.sh`
- **–ó–∞–¥–∞—á–∞:** `linkLinuxArm64Only`
- **–û–±—Ä–∞–∑:** `gates-opener-builder-arm64`

## üöÄ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (macOS)
```bash
# –ë—ã—Å—Ç—Ä–∞—è —Å–±–æ—Ä–∫–∞ –¥–ª—è macOS
./gradlew linkReleaseExecutableMacosArm64

# –°–±–æ—Ä–∫–∞ –≤—Å–µ—Ö Linux binaries
./gradlew linkLinuxBinaries
```

### CI/CD –∏–ª–∏ –ø—Ä–æ–¥–∞–∫—à–Ω
```bash
# –î–ª—è x86_64 —Å–µ—Ä–≤–µ—Ä–æ–≤
./build-linux.sh

# –î–ª—è ARM64 —Å–µ—Ä–≤–µ—Ä–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, AWS Graviton)
./build-linux-arm64.sh
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ x86_64 —Ä–µ–∂–∏–º–∞
./gradlew tasks --group build -Ddocker.build=true | grep link

# –ü—Ä–æ–≤–µ—Ä–∫–∞ ARM64 —Ä–µ–∂–∏–º–∞  
./gradlew tasks --group build -Ddocker.build.arm64=true | grep link

# –û–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º
./gradlew tasks --group build | grep link
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **ARM64 Docker —Å–±–æ—Ä–∫–∞** —Ç—Ä–µ–±—É–µ—Ç Docker —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π multi-arch
2. **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ —Ö–æ—Å—Ç–∞** –≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫—Ä–æ—Å—Å-–∫–æ–º–ø–∏–ª—è—Ü–∏–∏
3. **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ libcurl** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö
4. **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–±–æ—Ä–∫–∏** –≤—Å–µ–≥–¥–∞ –∫–æ–ø–∏—Ä—É—é—Ç—Å—è –≤ `gatesopener/bin/`

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: "Could not find kotlin-native-prebuilt-X-linux-aarch64.tar.gz"
**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π Docker —Ñ–∞–π–ª –∏ —Ñ–ª–∞–≥–∏:
- –î–ª—è x86_64: `./build-linux.sh`
- –î–ª—è ARM64: `./build-linux-arm64.sh`

### –ü—Ä–æ–±–ª–µ–º–∞: "Task not found"
**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–∏—Å—Ç–µ–º–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–ª–∞–≥–∏ –≤ Dockerfile –∏ –∑–∞–¥–∞—á–∞—Ö

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Å–±–æ—Ä–∫–∞
**–†–µ—à–µ–Ω–∏–µ:** 
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker layer caching
- –í–∫–ª—é—á–∏—Ç–µ Gradle daemon: `--daemon`
- –°–±–æ—Ä–∫–∞ –Ω–∞ –Ω–∞—Ç–∏–≤–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ –±—ã—Å—Ç—Ä–µ–µ

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ú–µ—Ç–æ–¥ | –í—Ä–µ–º—è | –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ —Ö–æ—Å—Ç–∞ | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|-------|-------|----------------|-----------|
| –õ–æ–∫–∞–ª—å–Ω–∞—è (macOS) | ~2 –º–∏–Ω | macOS ARM64 | –í—Å–µ targets |
| Docker x86_64 | ~5 –º–∏–Ω | macOS ARM64 | x86_64 —Ç–æ–ª—å–∫–æ |
| Docker ARM64 | ~3 –º–∏–Ω | macOS ARM64 | ARM64 —Ç–æ–ª—å–∫–æ |
| –ù–∞—Ç–∏–≤–Ω–∞—è ARM64 | ~1 –º–∏–Ω | Linux ARM64 | ARM64 —Ç–æ–ª—å–∫–æ |

–£—Å–ø–µ—à–Ω–æ–π —Å–±–æ—Ä–∫–∏! üéâ
